NOTE: “PROCEDURE PRINTTO”所用时间（总处理时间）:
      实际时间          0.00 秒
      CPU 时间          0.00 秒
      

96   
97   
98   
99   
100  proc sql;
101    create table pre as select
102    a.siteid 'SITE_ID',
103    a.subjid 'SUBJECT_NUMBER',
104    a.brthdat 'YEAR_OF_BIRTH',
105    b.visstage 'VISITNAME',
106    b.rsmethod 'MODALITY',
107    b.rsmecom 'MODALITY_OTHER',
108    b.rsdat 'EXAM DATE'
109    from derived.dm as a left join derived.rst1 as b on a.subjid=b.subjid;
NOTE: 表 WORK.PRE 创建完成，有 51 行，7 列。

110    quit;
NOTE: “PROCEDURE SQL”所用时间（总处理时间）:
      实际时间          0.01 秒
      CPU 时间          0.03 秒
      

111  
112  
113  proc sql;
114    create table pre1 as select
115    a.siteid 'SITE_ID',
116    a.subjid 'SUBJECT_NUMBER',
117    a.brthdat 'YEAR_OF_BIRTH',
118    b.visstage 'VISITNAME',
119    b.rsmethod 'MODALITY',
120    b.rsmecom 'MODALITY_OTHER',
121    b.rsdat 'EXAM DATE'
122    from derived.dm as a left join derived.rsnt1 as b on a.subjid=b.subjid;
NOTE: 表 WORK.PRE1 创建完成，有 52 行，7 列。

123    quit;
NOTE: “PROCEDURE SQL”所用时间（总处理时间）:
      实际时间          0.00 秒
      CPU 时间          0.00 秒
      

124  
125  data final;
126    set pre pre1;
127  run;

NOTE: 从数据集 WORK.PRE. 读取了 51 个观测
NOTE: 从数据集 WORK.PRE1. 读取了 52 个观测
NOTE: 数据集 WORK.FINAL 有 103 个观测和 7 个变量。
NOTE: “DATA 语句”所用时间（总处理时间）:
      实际时间          0.01 秒
      CPU 时间          0.01 秒
      

128  
129  proc sort data=final; by subjid;run;

NOTE: 从数据集 WORK.FINAL. 读取了 103 个观测
NOTE: 数据集 WORK.FINAL 有 103 个观测和 7 个变量。
NOTE: “PROCEDURE SORT”所用时间（总处理时间）:
      实际时间          0.00 秒
      CPU 时间          0.00 秒
      

130  
131  proc sort data=final nodupkeys; by _all_;run;

NOTE: 从数据集 WORK.FINAL. 读取了 103 个观测
NOTE: 47 个具有重复键值的观测已删除。
NOTE: 数据集 WORK.FINAL 有 56 个观测和 7 个变量。
NOTE: “PROCEDURE SORT”所用时间（总处理时间）:
      实际时间          0.01 秒
      CPU 时间          0.01 秒
      

132  
133  /*骨病灶*/
134    proc sql;
135    create table pre2 as select
136    a.siteid 'SITE_ID',
137    a.subjid 'SUBJECT_NUMBER',
138    b.visstage 'VISITNAME',
139    b.ectdat 'EXAM_DATE',
140    a.brthdat 'YEAR_OF_BIRTH'
141    from derived.dm as a left join derived.ect as b on a.subjid=b.subjid
142  order by a.subjid;
NOTE: 表 WORK.PRE2 创建完成，有 47 行，5 列。

143    quit;
NOTE: “PROCEDURE SQL”所用时间（总处理时间）:
      实际时间          0.01 秒
      CPU 时间          0.03 秒
      

144  
145  
146  
147  ods listing close;
148  ods RESULTS off;
149  ods excel file="..\output\&study.影像学拼接表_&sysdate..xlsx" options(  contents="no"  FROZEN_HEADERS="Yes"
149! autofilter='all' )  ;
150  ods excel options(embedded_titles='no' embedded_footnotes='no');
151  Options   nodate nonumber nocenter;
152  options nonotes;
153  OPTIONS FORMCHAR="|----|+|---+=|-<>*";
154  
155  ods excel options(sheet_name='肿瘤影像学拼接表');
156  proc report data=final;
157   column _all_;
158  DEFINE subjid / STYLE( column )={TAGATTR='type:text'};
159   run;
160  
161  ods excel options(sheet_name='骨扫描拼接表');
162  proc report data=pre2;
163   column _all_;
164  DEFINE subjid / STYLE( column )={TAGATTR='type:text'};
165   run;
166  
167  ***Save all information inclduing log files;
168  proc printto log=log; run;
